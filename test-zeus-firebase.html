<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zeus - Firebase Test</title>
    <link href="themes/theme-base.css" rel="stylesheet"/>
    <link href="styles.css" rel="stylesheet"/>
    <link href="themes/mythology-colors.css" rel="stylesheet"/>
    <style>
        :root {
            --mythos-primary: #DAA520;
            --mythos-secondary: #FFD700;
            --mythos-primary-rgb: 218, 165, 32;
        }

        body {
            background: #0a0a0a;
            color: #e0e0e0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 2rem;
        }

        .test-header {
            background: linear-gradient(135deg, var(--mythos-primary), var(--mythos-secondary));
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            text-align: center;
        }

        .loading {
            text-align: center;
            padding: 3rem;
            font-size: 1.2rem;
        }

        .error {
            background: rgba(220, 20, 60, 0.1);
            border: 2px solid #DC143C;
            padding: 2rem;
            border-radius: 10px;
            color: #DC143C;
        }

        .deity-header {
            background: linear-gradient(135deg, var(--mythos-primary), var(--mythos-secondary));
            color: white;
            padding: 3rem 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            position: relative;
        }

        .deity-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .attribute-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .attribute-card {
            background: rgba(218, 165, 32, 0.1);
            border: 1px solid rgba(218, 165, 32, 0.3);
            padding: 1.5rem;
            border-radius: 10px;
        }

        .attribute-label {
            color: var(--mythos-primary);
            font-weight: bold;
            font-size: 0.85rem;
            text-transform: uppercase;
            margin-bottom: 0.5rem;
        }

        .attribute-value {
            font-size: 1.1rem;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1rem 0;
        }

        h2 {
            color: var(--mythos-primary);
            margin-top: 2rem;
        }

        .verification-section {
            margin-top: 3rem;
            padding: 2rem;
            background: rgba(0, 255, 0, 0.1);
            border: 2px solid #00ff00;
            border-radius: 10px;
        }

        .verification-item {
            display: flex;
            align-items: center;
            margin: 0.5rem 0;
        }

        .verification-item::before {
            content: '‚úì';
            color: #00ff00;
            font-size: 1.5rem;
            margin-right: 1rem;
            font-weight: bold;
        }

        pre {
            background: #1a1a1a;
            padding: 1rem;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="test-header">
        <h1>üß™ Zeus Entity - Firebase Load Test</h1>
        <p>Testing FirebaseEntityRenderer with Zeus from Firestore</p>
    </div>

    <div id="loading-indicator" class="loading">
        ‚ö° Loading Zeus from Firebase...
    </div>

    <main id="entity-container" data-mythology="greek">
        <!-- Entity content will be rendered here -->
    </main>

    <div id="verification-section" class="verification-section" style="display: none;">
        <h2>‚úÖ Verification Results</h2>
        <div id="verification-results"></div>

        <h3>Raw Entity Data:</h3>
        <pre id="raw-data"></pre>
    </div>

    <!-- Firebase SDK (CDN) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>

    <!-- Entity Renderer -->
    <script src="js/entity-renderer-firebase.js"></script>

    <script>
        async function testZeusLoad() {
            const loadingEl = document.getElementById('loading-indicator');
            const container = document.getElementById('entity-container');
            const verificationSection = document.getElementById('verification-section');
            const verificationResults = document.getElementById('verification-results');
            const rawDataEl = document.getElementById('raw-data');

            try {
                // Initialize renderer
                const renderer = new FirebaseEntityRenderer();

                console.log('üî• Initializing Firebase...');
                await renderer.init();

                console.log('üì• Loading Zeus entity...');

                // Load Zeus directly
                const zeusData = await renderer.fetchEntity('deity', 'greek_deity_zeus');

                if (!zeusData) {
                    throw new Error('Zeus entity not found in Firestore');
                }

                console.log('‚úÖ Zeus loaded:', zeusData);

                // Hide loading
                loadingEl.style.display = 'none';

                // Render Zeus
                await renderer.loadAndRender('deity', 'greek_deity_zeus', 'greek', container);

                // Show verification
                verificationSection.style.display = 'block';

                // Verification checks
                const checks = [
                    { name: 'Entity ID', value: zeusData.id, expected: 'greek_deity_zeus' },
                    { name: 'Name', value: zeusData.name, expected: 'Zeus' },
                    { name: 'Icon (Special Char)', value: zeusData.icon, expected: '‚ö°' },
                    { name: 'Subtitle', value: zeusData.subtitle, expected: 'King of the Gods, God of Sky and Thunder' },
                    { name: 'Mythology', value: zeusData.mythology, expected: 'greek' },
                    { name: 'Type', value: zeusData.type, expected: 'deity' },
                    { name: 'Status', value: zeusData.status, expected: 'published' },
                    { name: 'Completeness', value: zeusData.completeness + '%', expected: '85.7%' },
                    { name: 'Titles Count', value: zeusData.titles?.length || 0, expected: '5' },
                    { name: 'Domains Count', value: zeusData.domains?.length || 0, expected: '8' },
                    { name: 'Symbols Count', value: zeusData.symbols?.length || 0, expected: '5' },
                    { name: 'Search Terms Count', value: zeusData.searchTerms?.length || 0, expected: '> 0' },
                ];

                let allPassed = true;
                checks.forEach(check => {
                    const passed = check.expected.startsWith('>')
                        ? parseInt(check.value) > 0
                        : String(check.value) === String(check.expected);

                    if (!passed) allPassed = false;

                    const div = document.createElement('div');
                    div.className = 'verification-item';
                    div.style.color = passed ? '#00ff00' : '#DC143C';
                    div.innerHTML = `<strong>${check.name}:</strong> ${check.value} ${passed ? '‚úì' : '‚úó (expected: ' + check.expected + ')'}`;
                    verificationResults.appendChild(div);
                });

                // Show raw data
                rawDataEl.textContent = JSON.stringify(zeusData, null, 2);

                // Summary
                const summary = document.createElement('div');
                summary.style.marginTop = '2rem';
                summary.style.fontSize = '1.2rem';
                summary.style.fontWeight = 'bold';
                summary.style.color = allPassed ? '#00ff00' : '#DC143C';
                summary.textContent = allPassed
                    ? 'üéâ ALL VERIFICATION CHECKS PASSED!'
                    : '‚ö†Ô∏è Some checks failed - see above';
                verificationResults.insertBefore(summary, verificationResults.firstChild);

                console.log('‚úÖ Test complete!');

            } catch (error) {
                console.error('‚ùå Error:', error);
                loadingEl.style.display = 'none';
                container.innerHTML = `
                    <div class="error">
                        <h2>Error Loading Zeus</h2>
                        <p>${error.message}</p>
                        <p><strong>Stack:</strong></p>
                        <pre>${error.stack}</pre>
                    </div>
                `;
            }
        }

        // Run test when page loads
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üß™ Starting Zeus Firebase test...');
            testZeusLoad();
        });
    </script>
</body>
</html>
