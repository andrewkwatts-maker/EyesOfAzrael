================================================================================
PHASE 2 MIGRATION PLAN - EXECUTION SUMMARY
Eyes of Azrael Firebase Migration
Date: December 13, 2024
================================================================================

CURRENT STATUS:
- Phase 1: COMPLETE (382 items, 70% migrated)
- Phase 2: PLANNED (420 items, 30% remaining)
- Total: 802 HTML files in mythos directory

DOCUMENTS CREATED:
✓ PHASE_2_MIGRATION_PLAN.md (35KB, 1,307 lines)
  - Comprehensive 26-hour migration plan
  - Detailed parser specifications
  - Risk assessment and mitigation
  - Testing strategy and rollback procedures

✓ PHASE_2_QUICK_REFERENCE.md (9.8KB, 395 lines)
  - At-a-glance execution guide
  - Command reference
  - Emergency procedures
  - Quality targets

REMAINING CONTENT BREAKDOWN:

┌──────────────────────────────────────────────┐
│ Priority | Category         | Files | Hours │
├──────────────────────────────────────────────┤
│ HIGHEST  | Simple Content   |  200  |  2-3  │
│ HIGH     | Sacred Texts     |   55  |  4-5  │
│ HIGH     | Gnostic Theology |   37  |  5-6  │
│ HIGH     | Kabbalah         |   31  |  5-6  │
│ MEDIUM   | SVG Graphics     |    2  |  2-3  │
│ LOW      | Unknown/Mixed    |   95  |  2-3  │
├──────────────────────────────────────────────┤
│ TOTAL    |                  |  420  | 20-26 │
└──────────────────────────────────────────────┘

SPECIALIZED PARSERS NEEDED:

1. parse-sacred-texts.js (NEW)
   - Scripture reference extraction
   - Cross-reference linking
   - Parallel passage detection
   - Dev time: 2 hours

2. parse-gnostic-content.js (NEW)
   - Aeon card parsing (divine emanations)
   - Quote card extraction (Nag Hammadi)
   - Theological hierarchy mapping
   - Dev time: 3 hours

3. parse-kabbalah-content.js (NEW)
   - Sefirot card extraction (Tree of Life)
   - Hebrew text handling (RTL encoding)
   - Divine name parsing (Tetragrammaton)
   - 288 Sparks angel grid
   - Dev time: 3 hours

4. extract-svg-graphics.js (NEW)
   - SVG file extraction
   - Firebase Storage upload
   - Asset reference updates
   - Dev time: 2 hours

TOTAL DEVELOPMENT TIME: 10 hours

EXECUTION TIMELINE:

Week 1: Simple Content + Sacred Texts (8 hours)
  Day 1-2: Migrate 200 files with universal parser
  Day 3:   Develop and run sacred texts parser

Week 2: Specialized Theological Content (12 hours)
  Day 1-2: Develop and migrate Gnostic content
  Day 3-4: Develop and migrate Kabbalah content

Week 3: Graphics + Cleanup (6 hours)
  Day 1:   Extract and upload SVG graphics
  Day 2:   Migrate unknown/mixed files
  Day 3:   Final testing and validation

TOTAL ESTIMATED TIME: 26 hours (3 weeks part-time)

KEY FEATURES OF SPECIALIZED PARSERS:

Gnostic Parser:
  ✓ .aeon-card extraction (syzygy pairs)
  ✓ .gnostic-topic-card parsing
  ✓ .quote-card extraction
  ✓ Theological hierarchy preservation
  ✓ Monad → Pleroma → Aeons structure

Kabbalah Parser:
  ✓ .sefirah-card extraction (10 emanations)
  ✓ .celestial-card parsing (angels/demons)
  ✓ Hebrew text (RTL) preservation
  ✓ .name-card parsing (divine names)
  ✓ Gematria value extraction
  ✓ Physics correlation mapping

Sacred Texts Parser:
  ✓ Scripture citations (e.g., "Rev 7:1-8")
  ✓ Cross-references ("See Also")
  ✓ Parallel passages (OT/NT)
  ✓ Chapter/testament detection

SVG Extraction:
  ✓ Direct .svg file upload
  ✓ Embedded <svg> extraction
  ✓ Firebase Storage integration
  ✓ Asset document URL linking

QUALITY TARGETS:
- Parse Success Rate: 95%+
- Validation Pass Rate: 90%+
- Data Completeness: 85%+
- Average Panels/Asset: 3+
- Cross-Reference Integrity: 95%+

RISK MITIGATION:
- Hebrew text encoding (UTF-8, RTL testing)
- Complex nested structures (preserve HTML)
- Broken cross-references (validation scripts)
- SVG quality (before/after testing)
- Unknown file types (fallback to universal parser)

TESTING STRATEGY:
1. Unit testing (3-5 sample files per parser)
2. Dry-run on category (test without writing)
3. Small batch upload (10-20 files first)
4. Full migration with validation
5. User acceptance testing

ROLLBACK CAPABILITY:
- Firestore exports before each batch
- Local backup of parsed data
- Timestamp-based deletion queries
- Resume capability after failures

DEPENDENCIES:
✓ Existing: cheerio, firebase-admin, cli-progress, glob
✗ New: @google-cloud/storage (for SVG upload)

INSTALL COMMAND:
$ npm install @google-cloud/storage --save

EXECUTION COMMANDS:

Batch 1 (Simple Content):
$ node scripts/migrate-to-firebase-assets.js --mythology apocryphal
$ node scripts/migrate-to-firebase-assets.js --mythology celtic

Batch 2 (Sacred Texts):
$ node scripts/parse-sacred-texts.js --dry-run --all
$ node scripts/parse-sacred-texts.js --all

Batch 3 (Gnostic):
$ node scripts/parse-gnostic-content.js --dry-run --mythology christian --path gnostic
$ node scripts/parse-gnostic-content.js --mythology christian --path gnostic

Batch 4 (Kabbalah):
$ node scripts/parse-kabbalah-content.js --dry-run --mythology jewish --path kabbalah
$ node scripts/parse-kabbalah-content.js --mythology jewish --path kabbalah

Batch 5 (SVG):
$ node scripts/extract-svg-graphics.js --scan
$ node scripts/extract-svg-graphics.js --upload

SUCCESS CRITERIA:
✓ All 420 files migrated to Firestore
✓ 95%+ parse success rate achieved
✓ All specialized parsers tested and working
✓ SVG graphics extracted and accessible
✓ Cross-references validated
✓ Frontend displays all content correctly
✓ Search indexes updated
✓ Documentation updated

NEXT STEPS:
1. Review and approve migration plan
2. Install @google-cloud/storage dependency
3. Begin Batch 1 (simple content - quick win)
4. Develop specialized parsers in parallel
5. Execute batches 2-5 sequentially with testing
6. Final validation and deployment

ESTIMATED COMPLETION: 2-3 weeks with careful testing

================================================================================
For detailed information, see:
- PHASE_2_MIGRATION_PLAN.md (full plan)
- PHASE_2_QUICK_REFERENCE.md (quick guide)
================================================================================
