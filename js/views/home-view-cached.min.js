class HomeViewCached{constructor(e,t){this.db=e,this.cache=t||window.cacheManager||new FirebaseCacheManager({db:e}),this.mythologies=[]}async render(e){performance.now();e.innerHTML='\n            <div class="loading-container">\n                <div class="spinner-container">\n                    <div class="spinner-ring"></div>\n                    <div class="spinner-ring"></div>\n                    <div class="spinner-ring"></div>\n                </div>\n                <p class="loading-message">Loading mythologies...</p>\n            </div>\n        ';try{await this.loadMythologiesCached(),e.innerHTML=this.getHomeHTML(),this.attachEventListeners(),performance.now(),this.cache.printStats()}catch(t){e.innerHTML=this.getErrorHTML(t)}}async loadMythologiesCached(){try{const e=await this.cache.getList("mythologies",{},{ttl:this.cache.defaultTTL.mythologies,orderBy:"name asc",limit:50});e&&e.length>0?(this.mythologies=e,this.loadCountsInBackground()):await this.loadFreshMythologies()}catch(e){this.mythologies=this.getFallbackMythologies()}}async loadFreshMythologies(){const e=await this.cache.getList("mythologies",{},{ttl:this.cache.defaultTTL.mythologies,orderBy:"name asc",limit:50});await this.loadCountsFromMetadata(e),this.mythologies=e}async loadCountsFromMetadata(e){try{const t=await this.cache.getMetadata("mythology_counts");t&&t.length>0?e.forEach(e=>{const o=t.find(t=>t.mythology===e.id);e.counts=o&&o.counts||{deities:0,heroes:0,creatures:0,total:0}}):await this.computeCountsFallback(e)}catch(t){e.forEach(e=>{e.counts={deities:0,heroes:0,creatures:0,total:0}})}}async computeCountsFallback(e){for(let t=0;t<e.length;t+=5){const o=e.slice(t,t+5);await Promise.all(o.map(async e=>{try{const[t,o,n]=await Promise.all([this.db.collection("deities").where("mythology","==",e.id).get(),this.db.collection("heroes").where("mythology","==",e.id).get(),this.db.collection("creatures").where("mythology","==",e.id).get()]);e.counts={deities:t.size,heroes:o.size,creatures:n.size,total:t.size+o.size+n.size}}catch(t){e.counts={deities:0,heroes:0,creatures:0,total:0}}}))}}loadCountsInBackground(){this.loadCountsFromMetadata(this.mythologies).then(()=>{}).catch(e=>{})}getFallbackMythologies(){return[{id:"greek",name:"Greek Mythology",icon:"<ï¿½",description:"Gods of Olympus and heroes of ancient Greece",color:"var(--color-primary, #8b7fff)",order:1,counts:{deities:45,heroes:23,creatures:18,total:86}},{id:"norse",name:"Norse Mythology",icon:"ï¿½",description:"Warriors of Asgard and the Nine Realms",color:"#4a9eff",order:2,counts:{deities:32,heroes:15,creatures:12,total:59}},{id:"egyptian",name:"Egyptian Mythology",icon:"\fï¿½",description:"Keepers of the Nile and guardians of Ma'at",color:"#ffd93d",order:3,counts:{deities:38,heroes:8,creatures:14,total:60}},{id:"hindu",name:"Hindu Mythology",icon:"=I",description:"The Trimurti and cosmic cycles of creation",color:"#ff7eb6",order:4,counts:{deities:42,heroes:19,creatures:16,total:77}},{id:"buddhist",name:"Buddhist Tradition",icon:"8",description:"Bodhisattvas and the path to enlightenment",color:"#51cf66",order:5,counts:{deities:28,heroes:12,creatures:9,total:49}},{id:"chinese",name:"Chinese Mythology",icon:"=\t",description:"Dragons, immortals, and celestial bureaucracy",color:"#f85a8f",order:6,counts:{deities:35,heroes:18,creatures:22,total:75}},{id:"japanese",name:"Japanese Mythology",icon:"ï¿½",description:"Kami spirits and the creation of Japan",color:"#fb9f7f",order:7,counts:{deities:29,heroes:11,creatures:13,total:53}},{id:"celtic",name:"Celtic Mythology",icon:"<@",description:"Druids, faeries, and the Tuatha Dï¿½ Danann",color:"#7fd9d3",order:8,counts:{deities:25,heroes:14,creatures:17,total:56}},{id:"babylonian",name:"Babylonian Mythology",icon:"<ï¿½",description:"The Enuma Elish and gods of Mesopotamia",color:"#b965e6",order:9,counts:{deities:22,heroes:7,creatures:8,total:37}},{id:"persian",name:"Persian Mythology",icon:"=%",description:"Zoroastrian wisdom and the eternal flame",color:"#7fb0f9",order:10,counts:{deities:18,heroes:9,creatures:11,total:38}},{id:"christian",name:"Christian Tradition",icon:"",description:"Angels, saints, and biblical narratives",color:"#a8edea",order:11,counts:{deities:15,heroes:21,creatures:6,total:42}},{id:"islamic",name:"Islamic Tradition",icon:"*",description:"Prophets, angels, and divine revelation",color:"#fed6e3",order:12,counts:{deities:12,heroes:18,creatures:5,total:35}}]}getHomeHTML(){return`\n            <div class="home-view">\n                \x3c!-- Hero Section --\x3e\n                <section class="hero-section">\n                    <div class="hero-content">\n                        <h1 class="hero-title">\n                            <span class="hero-icon">=A</span>\n                            Eyes of Azrael\n                        </h1>\n                        <p class="hero-subtitle">\n                            Explore World Mythologies\n                        </p>\n                        <p class="hero-description">\n                            Journey through 6000+ years of human mythology, from ancient Sumer to modern traditions.\n                            Discover deities, heroes, creatures, and sacred texts from cultures across the globe.\n                        </p>\n                        <div class="hero-actions">\n                            <a href="#/search" class="btn-primary">\n                                =\n Search Database\n                            </a>\n                            <a href="#/compare" class="btn-secondary">\n                                ï¿½ Compare Traditions\n                            </a>\n                        </div>\n                    </div>\n                </section>\n\n                \x3c!-- Mythology Cards Grid --\x3e\n                <section class="mythology-grid-section">\n                    <h2 class="section-title">Explore Mythologies</h2>\n                    <div class="mythology-grid">\n                        ${this.mythologies.map(e=>this.getMythologyCardHTML(e)).join("")}\n                    </div>\n                </section>\n\n                \x3c!-- Features Section --\x3e\n                <section class="features-section">\n                    <h2 class="section-title">Database Features</h2>\n                    <div class="features-grid">\n                        <div class="feature-card">\n                            <div class="feature-icon">=ï¿½</div>\n                            <h3>Comprehensive Database</h3>\n                            <p>Thousands of entities across 12+ mythological traditions</p>\n                        </div>\n                        <div class="feature-card">\n                            <div class="feature-icon">=</div>\n                            <h3>Cross-Cultural Links</h3>\n                            <p>Discover connections between different traditions</p>\n                        </div>\n                        <div class="feature-card">\n                            <div class="feature-icon"><?</div>\n                            <h3>Sacred Herbalism</h3>\n                            <p>Explore plants, rituals, and traditional practices</p>\n                        </div>\n                        <div class="feature-card">\n                            <div class="feature-icon">(</div>\n                            <h3>Magic Systems</h3>\n                            <p>Study mystical practices and esoteric traditions</p>\n                        </div>\n                    </div>\n                </section>\n\n                \x3c!-- Performance Info (debug mode) --\x3e\n                ${this.getPerformanceInfo()}\n            </div>\n        `}getMythologyCardHTML(e){const t=e.color||"var(--color-primary, #8b7fff)",o=e.counts||{deities:0,heroes:0,creatures:0,total:0};return`\n            <a href="#/mythology/${e.id}" class="mythology-card" data-mythology="${e.id}">\n                <div class="mythology-card-icon" style="color: ${t};">\n                    ${e.icon||"=ï¿½"}\n                </div>\n                <h3 class="mythology-card-title">${e.name}</h3>\n                <p class="mythology-card-description">${e.description}</p>\n                <div class="mythology-card-stats">\n                    ${o.deities>0?`<span class="stat-badge">=Q ${o.deities}</span>`:""}\n                    ${o.heroes>0?`<span class="stat-badge">>ï¿½ ${o.heroes}</span>`:""}\n                    ${o.creatures>0?`<span class="stat-badge">=\t ${o.creatures}</span>`:""}\n                </div>\n                <div class="mythology-card-arrow" style="color: ${t};">ï¿½</div>\n            </a>\n        `}getPerformanceInfo(){if(window.location.search.includes("debug")){const e=this.cache.getStats();return`\n                <div class="performance-debug" style="\n                    position: fixed;\n                    bottom: 20px;\n                    right: 20px;\n                    background: rgba(0, 0, 0, 0.9);\n                    padding: 1rem;\n                    border-radius: 8px;\n                    font-family: monospace;\n                    font-size: 0.85rem;\n                    z-index: 9999;\n                    max-width: 300px;\n                ">\n                    <h4 style="margin: 0 0 0.5rem 0; color: #51cf66;">ï¿½ Cache Stats</h4>\n                    <div style="color: #fff;">\n                        <div>Hit Rate: <strong style="color: #51cf66;">${e.hitRate}</strong></div>\n                        <div>Hits: ${e.hits}</div>\n                        <div>Misses: ${e.misses}</div>\n                        <div>Queries: ${e.queries}</div>\n                        <div>Avg Time: ${e.avgResponseTime}</div>\n                        <div>Cache Size: ${e.memoryCacheSize}</div>\n                    </div>\n                    <button onclick="window.cacheManager.clearAll(); location.reload();"\n                            style="\n                                margin-top: 0.5rem;\n                                padding: 0.25rem 0.5rem;\n                                background: #ef4444;\n                                border: none;\n                                border-radius: 4px;\n                                color: #fff;\n                                cursor: pointer;\n                            ">\n                        Clear Cache\n                    </button>\n                </div>\n            `}return""}getErrorHTML(e){return`\n            <div class="error-container" style="\n                text-align: center;\n                padding: 4rem 2rem;\n                max-width: 600px;\n                margin: 0 auto;\n            ">\n                <div style="font-size: 4rem; margin-bottom: 1rem;">ï¿½</div>\n                <h1>Error Loading Home Page</h1>\n                <p style="color: #ef4444; margin: 1rem 0;">${e.message}</p>\n                <button onclick="location.reload()" class="btn-primary">Reload Page</button>\n            </div>\n        `}attachEventListeners(){document.querySelectorAll(".mythology-card").forEach(e=>{e.addEventListener("mouseenter",()=>{})})}}"undefined"!=typeof module&&module.exports&&(module.exports=HomeViewCached);