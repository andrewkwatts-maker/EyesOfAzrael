class TheoryTaxonomy{constructor(){this.topics=this.getDefaultTopics(),this.customTopics=this.loadCustomTopics(),this.init()}getDefaultTopics(){return{mythologies:{name:"Mythologies",icon:"üåç",subtopics:{greek:"Greek Mythology",norse:"Norse Mythology",egyptian:"Egyptian Mythology",hindu:"Hindu Mythology",chinese:"Chinese Mythology",japanese:"Japanese Mythology",celtic:"Celtic Mythology",mesopotamian:"Mesopotamian Mythology",mesoamerican:"Mesoamerican Mythology",roman:"Roman Mythology",slavic:"Slavic Mythology",african:"African Mythology","native-american":"Native American Mythology",polynesian:"Polynesian Mythology",jewish:"Jewish Tradition"}},deities:{name:"Deities & Gods",icon:"‚ö°",subtopics:{"creator-gods":"Creator Gods","sky-gods":"Sky & Thunder Gods","earth-goddesses":"Earth & Mother Goddesses","war-deities":"War Deities","wisdom-deities":"Wisdom & Knowledge","love-deities":"Love & Beauty","death-deities":"Death & Underworld","solar-deities":"Solar Deities","lunar-deities":"Lunar Deities","sea-deities":"Sea & Water",tricksters:"Trickster Gods"}},cosmology:{name:"Cosmology & Creation",icon:"üåå",subtopics:{"creation-myths":"Creation Myths","cosmic-structure":"Cosmic Structure","world-trees":"World Trees","celestial-bodies":"Celestial Bodies",elements:"Elements & Forces",apocalypse:"End Times & Apocalypse"}},places:{name:"Sacred Places",icon:"üèõÔ∏è",subtopics:{temples:"Temples & Shrines",mountains:"Sacred Mountains","rivers-springs":"Rivers & Springs",caves:"Caves & Grottos",groves:"Sacred Groves",cities:"Sacred Cities",underworld:"Underworld Locations"}},items:{name:"Sacred Items & Artifacts",icon:"‚öîÔ∏è",subtopics:{weapons:"Weapons",armor:"Armor & Protection",tools:"Tools & Implements",relics:"Relics",jewelry:"Jewelry & Adornments",texts:"Sacred Texts"}},magic:{name:"Magic & Mysticism",icon:"‚ú®",subtopics:{divination:"Divination","ritual-magic":"Ritual Magic","energy-work":"Energy Work","practical-magic":"Practical Magic",grimoires:"Grimoires & Texts",traditions:"Magical Traditions"}},creatures:{name:"Mythical Creatures",icon:"üêâ",subtopics:{dragons:"Dragons",giants:"Giants",spirits:"Spirits & Elementals",monsters:"Monsters","hybrid-beings":"Hybrid Beings",undead:"Undead"}},heroes:{name:"Heroes & Legends",icon:"ü¶∏",subtopics:{demigods:"Demigods","legendary-kings":"Legendary Kings",warriors:"Warriors",prophets:"Prophets & Sages","culture-heroes":"Culture Heroes"}},concepts:{name:"Concepts & Archetypes",icon:"üí°",subtopics:{archetypes:"Universal Archetypes",symbols:"Symbols & Motifs",numbers:"Sacred Numbers","time-cycles":"Time & Cycles",duality:"Duality & Opposition"}},comparative:{name:"Comparative Analysis",icon:"üîó",subtopics:{patterns:"Cross-Cultural Patterns",evolution:"Myth Evolution",archaeology:"Archaeological Evidence",linguistics:"Linguistic Connections",astronomy:"Astronomical Interpretations",psychology:"Psychological Analysis"}},physics:{name:"Physics Integration",icon:"‚öõÔ∏è",subtopics:{"string-theory":"String Theory Connections",dimensions:"Extra Dimensions",quantum:"Quantum Interpretations",cosmological:"Cosmological Models",mathematical:"Mathematical Patterns"}},historical:{name:"Historical Context",icon:"üìú",subtopics:{"ancient-civilizations":"Ancient Civilizations",migrations:"Migrations & Diffusion","trade-routes":"Trade Routes","cultural-exchange":"Cultural Exchange",chronology:"Dating & Chronology"}}}}loadCustomTopics(){const e=localStorage.getItem("customTheoryTopics");return e?JSON.parse(e):{}}saveCustomTopics(){localStorage.setItem("customTheoryTopics",JSON.stringify(this.customTopics))}getAllTopics(){return{...this.topics,...this.customTopics}}getTopic(e){return this.topics[e]||this.customTopics[e]}getSubtopics(e){const o=this.getTopic(e);return o?o.subtopics:{}}addCustomTopic(e,o,t="üìå",s={}){return this.topics[e]?{success:!1,error:"Topic ID already exists in default topics"}:(this.customTopics[e]={name:o,icon:t,subtopics:s,custom:!0},this.saveCustomTopics(),{success:!0})}addSubtopic(e,o,t){let s=this.customTopics[e];if(!s){const o=this.topics[e];if(!o)return{success:!1,error:"Topic not found"};s={...o,subtopics:{...o.subtopics},custom:!1},this.customTopics[e]=s}return s.subtopics[o]?{success:!1,error:"Subtopic already exists"}:(s.subtopics[o]=t,this.saveCustomTopics(),{success:!0})}renderTopicSelector(e="",o=""){const t=this.getAllTopics();return`\n            <div class="topic-selector">\n                <div class="form-group">\n                    <label for="theory-topic">Topic *</label>\n                    <select id="theory-topic" name="topic" required>\n                        <option value="">Select a topic...</option>\n                        ${Object.entries(t).map(([o,t])=>`\n                            <option value="${o}" ${e===o?"selected":""}>\n                                ${t.icon} ${t.name}\n                            </option>\n                        `).join("")}\n                        <option value="_custom">‚ûï Create New Topic</option>\n                    </select>\n                </div>\n\n                <div class="form-group" id="subtopic-group" style="display: ${e?"block":"none"};">\n                    <label for="theory-subtopic">Subtopic *</label>\n                    <select id="theory-subtopic" name="subtopic" required>\n                        <option value="">Select a subtopic...</option>\n                        ${e?this.renderSubtopicOptions(e,o):""}\n                        <option value="_custom">‚ûï Create New Subtopic</option>\n                    </select>\n                </div>\n\n                \x3c!-- Custom topic input (hidden by default) --\x3e\n                <div id="custom-topic-input" class="form-group" style="display: none;">\n                    <label for="custom-topic-name">New Topic Name</label>\n                    <input type="text" id="custom-topic-name" placeholder="e.g., Astrology">\n                    <input type="text" id="custom-topic-icon" placeholder="Icon (emoji)" maxlength="2" value="üìå">\n                </div>\n\n                \x3c!-- Custom subtopic input (hidden by default) --\x3e\n                <div id="custom-subtopic-input" class="form-group" style="display: none;">\n                    <label for="custom-subtopic-name">New Subtopic Name</label>\n                    <input type="text" id="custom-subtopic-name" placeholder="e.g., Zodiac Signs">\n                </div>\n            </div>\n        `}renderSubtopicOptions(e,o=""){const t=this.getSubtopics(e);return Object.entries(t).map(([e,t])=>`\n            <option value="${e}" ${o===e?"selected":""}>\n                ${t}\n            </option>\n        `).join("")}attachTopicSelectorEvents(e){const o=e.querySelector("#theory-topic"),t=e.querySelector("#subtopic-group"),s=e.querySelector("#theory-subtopic"),i=e.querySelector("#custom-topic-input"),n=e.querySelector("#custom-subtopic-input");o?.addEventListener("change",e=>{const o=e.target.value;"_custom"===o?(i.style.display="block",t.style.display="none"):o?(i.style.display="none",t.style.display="block",s.innerHTML=`\n                    <option value="">Select a subtopic...</option>\n                    ${this.renderSubtopicOptions(o)}\n                    <option value="_custom">‚ûï Create New Subtopic</option>\n                `):(i.style.display="none",t.style.display="none")}),s?.addEventListener("change",e=>{"_custom"===e.target.value?n.style.display="block":n.style.display="none"})}getSelectedTopicData(e){const o=e.querySelector("#theory-topic"),t=e.querySelector("#theory-subtopic"),s=e.querySelector("#custom-topic-name"),i=e.querySelector("#custom-topic-icon"),n=e.querySelector("#custom-subtopic-name");let c=o?.value,r=t?.value;if("_custom"===c){const e=s?.value.trim(),o=i?.value.trim()||"üìå";if(!e)return null;c=e.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),this.addCustomTopic(c,e,o,{})}if("_custom"===r){const e=n?.value.trim();if(!e)return null;r=e.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),this.addSubtopic(c,r,e)}if(!c||!r)return null;const a=this.getTopic(c),l=a?.subtopics[r];return{topic:c,topicName:a?.name,topicIcon:a?.icon,subtopic:r,subtopicName:l}}init(){}}window.theoryTaxonomy=new TheoryTaxonomy,"undefined"!=typeof module&&module.exports&&(module.exports=TheoryTaxonomy);