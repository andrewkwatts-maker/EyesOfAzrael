!function(){"use strict";async function e(){try{const e=firebase.initializeApp(firebaseConfig);window.EyesOfAzrael.db=firebase.firestore(),window.EyesOfAzrael.auth=new AuthManager(e),await new Promise((e,n)=>{const a=firebase.auth().onAuthStateChanged(n=>{n?(e(n),a()):(e(null),a())})}),window.EyesOfAzrael.crudManager=new FirebaseCRUDManager(window.EyesOfAzrael.db,firebase.auth()),window.EyesOfAzrael.renderer=new UniversalDisplayRenderer({enableHover:!0,enableExpand:!0,enableCorpusLinks:!0,crudManager:window.EyesOfAzrael.crudManager}),window.EyesOfAzrael.navigation=new SPANavigation(window.EyesOfAzrael.db,window.EyesOfAzrael.auth,window.EyesOfAzrael.renderer),window.EyesOfAzrael.navigation.registerRoute("dashboard",async()=>{window.EyesOfAzrael.dashboard||(window.EyesOfAzrael.dashboard=new UserDashboard({crudManager:window.EyesOfAzrael.crudManager,auth:firebase.auth()}));const e=await window.EyesOfAzrael.dashboard.render(),n=document.getElementById("main-content");n.innerHTML=e,window.EyesOfAzrael.dashboard.initialize(n.querySelector(".user-dashboard"))}),window.EyesOfAzrael.search=new EnhancedCorpusSearch(window.EyesOfAzrael.db),window.EyesOfAzrael.shaders=new ShaderThemeManager({quality:"auto",targetFPS:60,enableStats:!1}),n(),window.EyesOfAzrael.auth.initAuthUI(),function(){const e=document.getElementById("themeToggle");if(e){let n="false"!==localStorage.getItem("darkMode");const a=()=>{n?(document.body.classList.add("dark-mode"),e.textContent="‚òÄÔ∏è"):(document.body.classList.remove("dark-mode"),e.textContent="üåô"),localStorage.setItem("darkMode",n)};e.addEventListener("click",()=>{n=!n,a()}),a()}const n=document.getElementById("shader-menu");if(n){const e=[{id:"water",name:"Water",icon:"üåä"},{id:"fire",name:"Fire",icon:"üî•"},{id:"night",name:"Night",icon:"üåô"},{id:"day",name:"Day",icon:"‚òÄÔ∏è"},{id:"earth",name:"Earth",icon:"üåø"},{id:"air",name:"Air",icon:"üí®"},{id:"light",name:"Light",icon:"‚ú®"},{id:"dark",name:"Dark",icon:"üåë"},{id:"order",name:"Order",icon:"‚öúÔ∏è"},{id:"chaos",name:"Chaos",icon:"üï≥Ô∏è"}];n.innerHTML=e.map(e=>`\n                <button class="shader-theme-btn" data-theme="${e.id}">\n                    ${e.icon} ${e.name}\n                </button>\n            `).join(""),n.addEventListener("click",e=>{if(e.target.classList.contains("shader-theme-btn")){const n=e.target.dataset.theme;window.EyesOfAzrael.shaders.activate(n),localStorage.setItem("preferredShaderTheme",n)}})}}(),document.addEventListener("click",async e=>{const n=e.target.closest("[data-crud-action]");if(!n)return;const r=n.dataset.crudAction,s=n.dataset.collection,o=n.dataset.entityId;switch(r){case"edit":await a(s,o);break;case"delete":await t(s,o);break;case"create":await i(s)}}),window.EyesOfAzrael.search.prefetchPopularEntities().catch(console.error)}catch(e){!function(e){const n=document.getElementById("main-content");n&&(n.innerHTML=`\n                <div class="error-container">\n                    <div class="error-icon">‚ö†Ô∏è</div>\n                    <h1>Initialization Error</h1>\n                    <p class="error-message">${e.message}</p>\n                    <button onclick="location.reload()" class="btn-primary">Reload Page</button>\n                </div>\n            `)}(e)}}function n(){const e=localStorage.getItem("preferredShaderTheme");if(e)return void window.EyesOfAzrael.shaders.activate(e);const n=window.location.hash;let a=null;if(n.includes("greek"))a="light";else if(n.includes("norse"))a="night";else if(n.includes("egyptian"))a="order";else if(n.includes("hindu"))a="fire";else if(n.includes("buddhist"))a="order";else if(n.includes("celtic"))a="earth";else if(n.includes("babylonian")||n.includes("sumerian"))a="chaos";else if(n.includes("chinese"))a="air";else if(n.includes("japanese")||n.includes("polynesian"))a="water";else{const e=(new Date).getHours();a=e>=6&&e<18?"day":"night"}window.EyesOfAzrael.shaders.activate(a,{intensity:.7,speed:1})}async function a(e,n){if(!firebase.auth().currentUser)return void r("Please sign in to edit entities","error");const a=document.createElement("div");a.className="form-overlay",document.body.appendChild(a);const t=new EntityForm({crudManager:window.EyesOfAzrael.crudManager,collection:e,entityId:n,onSuccess:async e=>{a.remove(),r("Entity updated successfully!","success"),window.EyesOfAzrael.navigation&&await window.EyesOfAzrael.navigation.navigate(window.location.hash)},onCancel:()=>{a.remove()}}),i=await t.render();a.innerHTML=i;const s=a.querySelector(".entity-form-container");t.initialize(s)}async function t(e,n){if(!firebase.auth().currentUser)return void r("Please sign in to delete entities","error");if(!confirm("Are you sure you want to delete this entity?"))return;const a=await window.EyesOfAzrael.crudManager.delete(e,n);a.success?(r("Entity deleted successfully","success"),window.EyesOfAzrael.navigation&&await window.EyesOfAzrael.navigation.navigate(window.location.hash)):r(`Failed to delete: ${a.error}`,"error")}async function i(e){if(!firebase.auth().currentUser)return void r("Please sign in to create entities","error");const n=document.createElement("div");n.className="form-overlay",document.body.appendChild(n);const a=new EntityForm({crudManager:window.EyesOfAzrael.crudManager,collection:e,onSuccess:async a=>{n.remove(),r("Entity created successfully!","success"),window.EyesOfAzrael.navigation&&a.id&&(e.slice(0,-1),await window.EyesOfAzrael.navigation.navigate(`#/entity/${e}/${a.id}`))},onCancel:()=>{n.remove()}}),t=await a.render();n.innerHTML=t;const i=n.querySelector(".entity-form-container");a.initialize(i)}function r(e,n="info"){window.toast?window.toast[n](e):alert(e)}window.EyesOfAzrael={auth:null,navigation:null,search:null,renderer:null,shaders:null,db:null,crudManager:null,dashboard:null},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e(),window.addEventListener("hashchange",()=>{localStorage.getItem("preferredShaderTheme")||n()}),window.debugApp=function(){return{auth:window.EyesOfAzrael.auth,navigation:window.EyesOfAzrael.navigation,search:window.EyesOfAzrael.search,renderer:window.EyesOfAzrael.renderer,shaders:window.EyesOfAzrael.shaders,db:window.EyesOfAzrael.db,crudManager:window.EyesOfAzrael.crudManager,dashboard:window.EyesOfAzrael.dashboard}},window.createEntity=async e=>{await i(e)},window.editEntity=async(e,n)=>{await a(e,n)},window.deleteEntity=async(e,n)=>{await t(e,n)}}();