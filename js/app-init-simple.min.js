!async function(){"use strict";"loading"===document.readyState&&await new Promise(e=>document.addEventListener("DOMContentLoaded",e));try{if("undefined"==typeof firebase)throw new Error("Firebase SDK not loaded");let e;if(0===firebase.apps.length){if("undefined"==typeof firebaseConfig)throw new Error("Firebase config not found");e=firebase.initializeApp(firebaseConfig)}else e=firebase.app();const n=firebase.firestore(),t=firebase.auth();if(window.EyesOfAzrael=window.EyesOfAzrael||{},window.EyesOfAzrael.db=n,window.EyesOfAzrael.firebaseAuth=t,"undefined"!=typeof AuthManager&&(window.EyesOfAzrael.auth=new AuthManager(e)),"undefined"!=typeof FirebaseCRUDManager&&(window.EyesOfAzrael.crudManager=new FirebaseCRUDManager(n,t)),"undefined"!=typeof UniversalDisplayRenderer&&(window.EyesOfAzrael.renderer=new UniversalDisplayRenderer({enableHover:!0,enableExpand:!0,enableCorpusLinks:!0})),"undefined"!=typeof SPANavigation&&window.EyesOfAzrael.renderer&&(window.EyesOfAzrael.navigation=new SPANavigation(n,window.EyesOfAzrael.auth,window.EyesOfAzrael.renderer)),"undefined"!=typeof EnhancedCorpusSearch&&(window.EyesOfAzrael.search=new EnhancedCorpusSearch(n)),"undefined"!=typeof ShaderThemeManager){window.EyesOfAzrael.shaders=new ShaderThemeManager({quality:"auto",targetFPS:60});const e=(new Date).getHours(),n=e>=6&&e<18?"day":"night";window.EyesOfAzrael.shaders.activate(n)}window.EyesOfAzrael.auth&&function(e){const n=document.getElementById("userInfo"),t=document.getElementById("userName"),a=document.getElementById("userAvatar"),r=document.getElementById("signOutBtn");n&&(e.onAuthStateChanged(e=>{e?(n.style.display="flex",t.textContent=e.displayName||e.email,a&&e.photoURL&&(a.src=e.photoURL)):n.style.display="none"}),r&&r.addEventListener("click",async()=>{try{await e.signOut()}catch(e){}}))}(t),window.addEventListener("error",e=>{window.AnalyticsManager&&window.AnalyticsManager.trackCustomError(e.error||new Error(e.message),{fatal:!0,filename:e.filename,lineno:e.lineno,colno:e.colno,type:"javascript_error"})}),window.addEventListener("unhandledrejection",e=>{window.AnalyticsManager&&window.AnalyticsManager.trackCustomError(e.reason instanceof Error?e.reason:new Error(String(e.reason)),{fatal:!1,type:"unhandled_promise_rejection"})}),document.addEventListener("click",async e=>{const n=e.target.matches(".edit-icon-btn")?e.target:e.target.closest(".edit-icon-btn");if(!n)return;e.preventDefault(),e.stopPropagation();const t=n.dataset.entityId,a=n.dataset.collection;if(t&&a)if("undefined"!=typeof EditEntityModal)if(window.EyesOfAzrael&&window.EyesOfAzrael.crudManager)try{const e=new EditEntityModal(window.EyesOfAzrael.crudManager);await e.open(t,a)}catch(e){alert("Failed to open edit modal: "+e.message)}else alert("Edit functionality not available. Please ensure the app is properly initialized.");else alert("Edit functionality not available. Please ensure all scripts are loaded.")}),document.dispatchEvent(new CustomEvent("app-initialized")),document.addEventListener("first-render-complete",()=>{const e=document.querySelector(".loading-container");e&&(e.style.opacity="0",e.style.transition="opacity 0.3s ease",setTimeout(()=>{e.style.display="none"},300))},{once:!0})}catch(e){!function(e){const n=document.getElementById("main-content");n&&(n.innerHTML=`\n                <div class="error-container" style="\n                    text-align: center;\n                    padding: 3rem;\n                    max-width: 600px;\n                    margin: 0 auto;\n                ">\n                    <div style="font-size: 4rem; margin-bottom: 1rem;">⚠️</div>\n                    <h1>Initialization Error</h1>\n                    <p style="color: #ef4444; margin: 1rem 0;">${e.message}</p>\n                    <button onclick="location.reload()" class="btn-primary">Reload Page</button>\n                </div>\n            `)}(e)}window.debugApp=function(){return window.EyesOfAzrael||{}}}();