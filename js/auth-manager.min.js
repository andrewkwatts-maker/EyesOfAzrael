class AuthManager{constructor(t){this.auth=firebase.auth(),this.currentUser=null,this.onAuthStateChangedCallbacks=[],this.googleProvider=new firebase.auth.GoogleAuthProvider,this.googleProvider.addScope("profile"),this.googleProvider.addScope("email"),this.initAuthStateListener()}initAuthStateListener(){this.auth.onAuthStateChanged(t=>{this.currentUser=t,this.updateAuthUI(t),this.onAuthStateChangedCallbacks.forEach(e=>e(t))})}async signInWithGoogle(){try{return(await this.auth.signInWithPopup(this.googleProvider)).user}catch(t){throw this.handleAuthError(t),t}}async signInWithGoogleRedirect(){try{await this.auth.signInWithRedirect(this.googleProvider)}catch(t){throw this.handleAuthError(t),t}}async getRedirectResult(){try{const t=await this.auth.getRedirectResult();if(t.user)return t.user}catch(t){this.handleAuthError(t)}return null}async signOut(){try{await this.auth.signOut()}catch(t){throw t}}isAuthenticated(){return null!==this.currentUser}getCurrentUser(){return this.currentUser}onAuthStateChanged(t){this.onAuthStateChangedCallbacks.push(t)}updateAuthUI(t){document.getElementById("auth-container");const e=document.getElementById("user-info"),n=document.getElementById("sign-in-btn"),i=document.getElementById("sign-out-btn"),s=document.getElementById("login-page"),a=document.getElementById("main-content");t?(s&&(s.style.display="none"),a&&(a.style.display="block"),e&&(e.innerHTML=`\n                    <div class="user-profile">\n                        <img src="${t.photoURL||"/images/default-avatar.png"}"\n                             alt="${t.displayName}"\n                             class="user-avatar">\n                        <div class="user-details">\n                            <div class="user-name">${t.displayName||"User"}</div>\n                            <div class="user-email">${t.email}</div>\n                        </div>\n                    </div>\n                `,e.style.display="block"),n&&(n.style.display="none"),i&&(i.style.display="block")):(s&&(s.style.display="flex"),a&&(a.style.display="none"),e&&(e.innerHTML="",e.style.display="none"),n&&(n.style.display="block"),i&&(i.style.display="none"))}handleAuthError(t){let e="Authentication error occurred";switch(t.code){case"auth/popup-closed-by-user":e="Sign-in popup was closed";break;case"auth/popup-blocked":e="Sign-in popup was blocked. Please allow popups for this site.";break;case"auth/cancelled-popup-request":e="Sign-in cancelled";break;case"auth/account-exists-with-different-credential":e="An account already exists with this email";break;case"auth/network-request-failed":e="Network error. Please check your connection.";break;default:e=t.message}this.showAuthError(e)}showAuthError(t){const e=document.getElementById("auth-error");e?(e.textContent=t,e.style.display="block",setTimeout(()=>{e.style.display="none"},5e3)):alert(t)}async requireAuth(){return new Promise(t=>{const e=this.auth.onAuthStateChanged(n=>{n&&(t(n),e())})})}initAuthUI(){const t=document.getElementById("sign-in-btn");t&&t.addEventListener("click",async()=>{t.disabled=!0,t.textContent="Signing in...";try{/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)?await this.signInWithGoogleRedirect():await this.signInWithGoogle()}catch(t){}finally{t.disabled=!1,t.textContent="Sign in with Google"}});const e=document.getElementById("sign-out-btn");e&&e.addEventListener("click",async()=>{confirm("Are you sure you want to sign out?")&&await this.signOut()}),this.getRedirectResult()}}"undefined"!=typeof module&&module.exports&&(module.exports=AuthManager);