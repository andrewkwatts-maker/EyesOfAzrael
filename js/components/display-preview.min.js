class DisplayPreview{constructor(e,t={}){this.container=e,this.options={initialMode:t.initialMode||"grid",onModeChange:t.onModeChange||null,autoUpdate:!1!==t.autoUpdate,...t},this.currentMode=this.options.initialMode,this.previewData=null,this.renderers={},this.init()}init(){this.render(),this.attachEventListeners(),this.initializeRenderers()}initializeRenderers(){window.AttributeGridRenderer&&(this.renderers.grid=window.AttributeGridRenderer),window.MythListRenderer&&(this.renderers.list=window.MythListRenderer),window.GridPanelEditor&&(this.renderers.panel=window.GridPanelEditor)}render(){this.container.innerHTML=`\n            <div class="display-preview">\n                \x3c!-- Mode Switcher Tabs --\x3e\n                <div class="preview-mode-tabs">\n                    <button type="button"\n                            class="preview-tab ${"grid"===this.currentMode?"active":""}"\n                            data-mode="grid"\n                            title="Grid View">\n                        <span class="tab-icon">‚äû</span>\n                        <span class="tab-label">Grid</span>\n                    </button>\n                    <button type="button"\n                            class="preview-tab ${"list"===this.currentMode?"active":""}"\n                            data-mode="list"\n                            title="List View">\n                        <span class="tab-icon">‚ò∞</span>\n                        <span class="tab-label">List</span>\n                    </button>\n                    <button type="button"\n                            class="preview-tab ${"table"===this.currentMode?"active":""}"\n                            data-mode="table"\n                            title="Table View">\n                        <span class="tab-icon">‚äü</span>\n                        <span class="tab-label">Table</span>\n                    </button>\n                    <button type="button"\n                            class="preview-tab ${"panel"===this.currentMode?"active":""}"\n                            data-mode="panel"\n                            title="Panel View">\n                        <span class="tab-icon">üìã</span>\n                        <span class="tab-label">Panel</span>\n                    </button>\n                </div>\n\n                \x3c!-- Preview Content Area --\x3e\n                <div class="preview-content-wrapper">\n                    <div class="preview-header">\n                        <h3 class="preview-title">Live Preview</h3>\n                        <div class="preview-controls">\n                            <button type="button"\n                                    class="btn-preview-refresh"\n                                    data-action="refresh"\n                                    title="Refresh Preview">\n                                üîÑ Refresh\n                            </button>\n                            <button type="button"\n                                    class="btn-preview-fullscreen"\n                                    data-action="fullscreen"\n                                    title="Toggle Fullscreen">\n                                ‚õ∂ Fullscreen\n                            </button>\n                        </div>\n                    </div>\n\n                    <div class="preview-content" id="preview-render-area">\n                        ${this.renderEmptyState()}\n                    </div>\n                </div>\n\n                \x3c!-- Preview Info Bar --\x3e\n                <div class="preview-info-bar">\n                    <span class="preview-mode-indicator">\n                        Current Mode: <strong>${this.getModeLabel(this.currentMode)}</strong>\n                    </span>\n                    <span class="preview-update-time" id="preview-update-time">\n                        Never updated\n                    </span>\n                </div>\n            </div>\n        `}renderEmptyState(){return'\n            <div class="preview-empty-state">\n                <div class="empty-state-icon">üëÅÔ∏è</div>\n                <p class="empty-state-text">Fill in the form to see a preview</p>\n                <p class="empty-state-hint">Your submission will appear here as you type</p>\n            </div>\n        '}attachEventListeners(){this.container.addEventListener("click",e=>{const t=e.target.closest(".preview-tab");if(t){const e=t.dataset.mode;return void this.switchMode(e)}const n=e.target.dataset.action;"refresh"===n?this.refresh():"fullscreen"===n&&this.toggleFullscreen()})}switchMode(e){if(this.currentMode===e)return;this.currentMode=e,this.container.querySelectorAll(".preview-tab").forEach(t=>{t.classList.toggle("active",t.dataset.mode===e)});const t=this.container.querySelector(".preview-mode-indicator strong");t&&(t.textContent=this.getModeLabel(e)),this.previewData&&this.updatePreview(this.previewData),this.options.onModeChange&&this.options.onModeChange(e)}updatePreview(e){this.previewData=e;const t=this.container.querySelector("#preview-render-area");if(e&&0!==Object.keys(e).length)try{let n="";switch(this.currentMode){case"grid":n=this.renderGridView(e);break;case"list":n=this.renderListView(e);break;case"table":n=this.renderTableView(e);break;case"panel":n=this.renderPanelView(e);break;default:n=this.renderEmptyState()}t.innerHTML=n,this.updateTimestamp()}catch(e){t.innerHTML=`\n                <div class="preview-error">\n                    <p>Error rendering preview</p>\n                    <small>${this.escapeHtml(e.message)}</small>\n                </div>\n            `}else t.innerHTML=this.renderEmptyState()}renderGridView(e){return`\n            <div class="preview-grid-container">\n                <div class="preview-grid" style="grid-template-columns: repeat(${e.displayOptions?.gridSize||3}, 1fr);">\n                    ${this.renderGridItems(e)}\n                </div>\n            </div>\n        `}renderGridItems(e){const t=[];return e.title&&t.push(`\n                <div class="preview-grid-item preview-item-title">\n                    <h3>${this.escapeHtml(e.title)}</h3>\n                    ${e.subtitle?`<p class="item-subtitle">${this.escapeHtml(e.subtitle)}</p>`:""}\n                </div>\n            `),e.description&&t.push(`\n                <div class="preview-grid-item preview-item-description">\n                    <h4>Description</h4>\n                    <p>${this.escapeHtml(e.description)}</p>\n                </div>\n            `),e.category&&t.push(`\n                <div class="preview-grid-item preview-item-metadata">\n                    <h4>Category</h4>\n                    <p>${this.escapeHtml(e.category)}</p>\n                </div>\n            `),e.mythology&&t.push(`\n                <div class="preview-grid-item preview-item-metadata">\n                    <h4>Mythology</h4>\n                    <p>${this.escapeHtml(e.mythology)}</p>\n                </div>\n            `),e.customFields&&Array.isArray(e.customFields)&&e.customFields.forEach(e=>{e.value&&t.push(`\n                        <div class="preview-grid-item preview-item-field">\n                            <h4>${this.escapeHtml(e.label||e.name)}</h4>\n                            <p>${this.escapeHtml(e.value)}</p>\n                        </div>\n                    `)}),t.join("")||'<p class="preview-no-content">No content to display</p>'}renderListView(e){return`\n            <div class="preview-list-container">\n                ${e.title?`<h2 class="preview-list-title">${this.escapeHtml(e.title)}</h2>`:""}\n                ${e.subtitle?`<p class="preview-list-subtitle">${this.escapeHtml(e.subtitle)}</p>`:""}\n\n                <div class="preview-list-content">\n                    ${this.renderListItems(e)}\n                </div>\n            </div>\n        `}renderListItems(e){const t=[];return e.description&&t.push(`\n                <div class="preview-list-item">\n                    <span class="list-item-label">Description:</span>\n                    <span class="list-item-value">${this.escapeHtml(e.description)}</span>\n                </div>\n            `),e.category&&t.push(`\n                <div class="preview-list-item">\n                    <span class="list-item-label">Category:</span>\n                    <span class="list-item-value">${this.escapeHtml(e.category)}</span>\n                </div>\n            `),e.mythology&&t.push(`\n                <div class="preview-list-item">\n                    <span class="list-item-label">Mythology:</span>\n                    <span class="list-item-value">${this.escapeHtml(e.mythology)}</span>\n                </div>\n            `),e.customFields&&Array.isArray(e.customFields)&&e.customFields.forEach(e=>{e.value&&t.push(`\n                        <div class="preview-list-item">\n                            <span class="list-item-label">${this.escapeHtml(e.label||e.name)}:</span>\n                            <span class="list-item-value">${this.escapeHtml(e.value)}</span>\n                        </div>\n                    `)}),t.join("")||'<p class="preview-no-content">No content to display</p>'}renderTableView(e){return`\n            <div class="preview-table-container">\n                ${e.title?`<h2 class="preview-table-title">${this.escapeHtml(e.title)}</h2>`:""}\n\n                <table class="preview-table">\n                    <thead>\n                        <tr>\n                            <th>Property</th>\n                            <th>Value</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        ${this.renderTableRows(e)}\n                    </tbody>\n                </table>\n            </div>\n        `}renderTableRows(e){const t=[];return e.title&&t.push(`\n                <tr>\n                    <td class="table-label">Title</td>\n                    <td class="table-value">${this.escapeHtml(e.title)}</td>\n                </tr>\n            `),e.subtitle&&t.push(`\n                <tr>\n                    <td class="table-label">Subtitle</td>\n                    <td class="table-value">${this.escapeHtml(e.subtitle)}</td>\n                </tr>\n            `),e.description&&t.push(`\n                <tr>\n                    <td class="table-label">Description</td>\n                    <td class="table-value">${this.escapeHtml(e.description)}</td>\n                </tr>\n            `),e.category&&t.push(`\n                <tr>\n                    <td class="table-label">Category</td>\n                    <td class="table-value">${this.escapeHtml(e.category)}</td>\n                </tr>\n            `),e.mythology&&t.push(`\n                <tr>\n                    <td class="table-label">Mythology</td>\n                    <td class="table-value">${this.escapeHtml(e.mythology)}</td>\n                </tr>\n            `),e.customFields&&Array.isArray(e.customFields)&&e.customFields.forEach(e=>{e.value&&t.push(`\n                        <tr>\n                            <td class="table-label">${this.escapeHtml(e.label||e.name)}</td>\n                            <td class="table-value">${this.escapeHtml(e.value)}</td>\n                        </tr>\n                    `)}),t.join("")||'<tr><td colspan="2" class="preview-no-content">No content to display</td></tr>'}renderPanelView(e){return`\n            <div class="preview-panel-container">\n                <div class="preview-panel">\n                    ${e.title?`\n                        <div class="panel-header">\n                            <h2 class="panel-title">${this.escapeHtml(e.title)}</h2>\n                            ${e.subtitle?`<p class="panel-subtitle">${this.escapeHtml(e.subtitle)}</p>`:""}\n                        </div>\n                    `:""}\n\n                    <div class="panel-body">\n                        ${this.renderPanelSections(e)}\n                    </div>\n                </div>\n            </div>\n        `}renderPanelSections(e){const t=[];e.description&&t.push(`\n                <div class="panel-section">\n                    <h3 class="section-heading">Description</h3>\n                    <p class="section-content">${this.escapeHtml(e.description)}</p>\n                </div>\n            `);const n=[];return e.category&&n.push(`<p><strong>Category:</strong> ${this.escapeHtml(e.category)}</p>`),e.mythology&&n.push(`<p><strong>Mythology:</strong> ${this.escapeHtml(e.mythology)}</p>`),n.length>0&&t.push(`\n                <div class="panel-section">\n                    <h3 class="section-heading">Details</h3>\n                    <div class="section-content">\n                        ${n.join("")}\n                    </div>\n                </div>\n            `),e.customFields&&Array.isArray(e.customFields)&&e.customFields.length>0&&e.customFields.some(e=>e.value)&&t.push(`\n                    <div class="panel-section">\n                        <h3 class="section-heading">Additional Information</h3>\n                        <div class="section-content">\n                            ${e.customFields.filter(e=>e.value).map(e=>`\n                                <p><strong>${this.escapeHtml(e.label||e.name)}:</strong> ${this.escapeHtml(e.value)}</p>\n                            `).join("")}\n                        </div>\n                    </div>\n                `),t.join("")||'<p class="preview-no-content">No content to display</p>'}refresh(){this.previewData&&this.updatePreview(this.previewData)}toggleFullscreen(){const e=this.container.querySelector(".preview-content-wrapper");if(e)if(e.classList.contains("fullscreen")){e.classList.remove("fullscreen");const t=this.container.querySelector(".btn-preview-fullscreen");t&&(t.textContent="‚õ∂ Fullscreen")}else{e.classList.add("fullscreen");const t=this.container.querySelector(".btn-preview-fullscreen");t&&(t.textContent="‚õ∂ Exit Fullscreen")}}updateTimestamp(){const e=this.container.querySelector("#preview-update-time");if(e){const t=new Date;e.textContent=`Last updated: ${t.toLocaleTimeString()}`}}getModeLabel(e){return{grid:"Grid View",list:"List View",table:"Table View",panel:"Panel View"}[e]||e}getMode(){return this.currentMode}setData(e){this.updatePreview(e)}escapeHtml(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}destroy(){this.container.innerHTML="",this.previewData=null,this.renderers={}}}window.DisplayPreview=DisplayPreview;