class FilterSettingsModal{constructor(){this.modal=null,this.init()}init(){this.createModal(),this.attachEventListeners(),window.addEventListener("contentFilterChanged",()=>{this.modal&&"none"!==this.modal.style.display&&this.updateUI()})}createModal(){document.body.insertAdjacentHTML("beforeend",'\n            <div id="filter-settings-modal" class="filter-modal" style="display: none;">\n                <div class="filter-modal-overlay"></div>\n                <div class="filter-modal-content">\n                    <div class="filter-modal-header">\n                        <h2>üéõÔ∏è Content Filter Settings</h2>\n                        <button type="button" class="filter-modal-close" aria-label="Close">&times;</button>\n                    </div>\n\n                    <div class="filter-modal-body">\n                        \x3c!-- Filter Mode Selection --\x3e\n                        <section class="filter-section">\n                            <h3>üìä Content Visibility Mode</h3>\n                            <p class="filter-description">Choose what content to display throughout the site</p>\n\n                            <div class="filter-mode-options">\n                                <label class="filter-mode-card">\n                                    <input type="radio" name="filter-mode" value="defaults-only">\n                                    <div class="mode-card-content">\n                                        <div class="mode-icon">üèõÔ∏è</div>\n                                        <div class="mode-label">Official Only</div>\n                                        <div class="mode-description">Official Eyes of Azrael content</div>\n                                    </div>\n                                </label>\n\n                                <label class="filter-mode-card">\n                                    <input type="radio" name="filter-mode" value="defaults-self">\n                                    <div class="mode-card-content">\n                                        <div class="mode-icon">üèõÔ∏è + üë§</div>\n                                        <div class="mode-label">Official + Mine</div>\n                                        <div class="mode-description">Official + your submissions</div>\n                                    </div>\n                                </label>\n\n                                <label class="filter-mode-card">\n                                    <input type="radio" name="filter-mode" value="everyone">\n                                    <div class="mode-card-content">\n                                        <div class="mode-icon">üåç</div>\n                                        <div class="mode-label">Everyone</div>\n                                        <div class="mode-description">Full wiki experience</div>\n                                    </div>\n                                </label>\n                            </div>\n                        </section>\n\n                        \x3c!-- Hidden Items Management --\x3e\n                        <section class="filter-section">\n                            <h3>üö´ Hidden Items</h3>\n                            <p class="filter-description">Manage individually hidden users, topics, and subtopics</p>\n\n                            <div class="hidden-items-tabs">\n                                <button type="button" class="hidden-tab active" data-tab="users">\n                                    Users (<span id="hidden-users-count">0</span>)\n                                </button>\n                                <button type="button" class="hidden-tab" data-tab="topics">\n                                    Topics (<span id="hidden-topics-count">0</span>)\n                                </button>\n                                <button type="button" class="hidden-tab" data-tab="subtopics">\n                                    Subtopics (<span id="hidden-subtopics-count">0</span>)\n                                </button>\n                            </div>\n\n                            <div class="hidden-items-content">\n                                <div class="hidden-items-panel active" id="hidden-users-panel">\n                                    <div id="hidden-users-list" class="hidden-items-list"></div>\n                                </div>\n                                <div class="hidden-items-panel" id="hidden-topics-panel">\n                                    <div id="hidden-topics-list" class="hidden-items-list"></div>\n                                </div>\n                                <div class="hidden-items-panel" id="hidden-subtopics-panel">\n                                    <div id="hidden-subtopics-list" class="hidden-items-list"></div>\n                                </div>\n                            </div>\n\n                            <button type="button" class="btn-clear-all" id="clear-all-hidden">\n                                Clear All Hidden Items\n                            </button>\n                        </section>\n\n                        \x3c!-- Statistics --\x3e\n                        <section class="filter-section filter-stats">\n                            <h3>üìà Current Settings</h3>\n                            <div class="stats-grid">\n                                <div class="stat-item">\n                                    <div class="stat-label">Mode</div>\n                                    <div class="stat-value" id="current-mode-label">‚Äî</div>\n                                </div>\n                                <div class="stat-item">\n                                    <div class="stat-label">Hidden Users</div>\n                                    <div class="stat-value" id="stat-hidden-users">0</div>\n                                </div>\n                                <div class="stat-item">\n                                    <div class="stat-label">Hidden Topics</div>\n                                    <div class="stat-value" id="stat-hidden-topics">0</div>\n                                </div>\n                                <div class="stat-item">\n                                    <div class="stat-label">Hidden Subtopics</div>\n                                    <div class="stat-value" id="stat-hidden-subtopics">0</div>\n                                </div>\n                            </div>\n                        </section>\n                    </div>\n\n                    <div class="filter-modal-footer">\n                        <button type="button" class="btn btn-secondary" id="filter-modal-cancel">\n                            Close\n                        </button>\n                    </div>\n                </div>\n            </div>\n        '),this.modal=document.getElementById("filter-settings-modal")}attachEventListeners(){[this.modal.querySelector(".filter-modal-close"),this.modal.querySelector("#filter-modal-cancel"),this.modal.querySelector(".filter-modal-overlay")].forEach(t=>{t.addEventListener("click",()=>this.close())}),this.modal.querySelectorAll('input[name="filter-mode"]').forEach(t=>{t.addEventListener("change",t=>{t.target.checked&&window.contentFilter&&(window.contentFilter.setMode(t.target.value),this.updateUI())})}),this.modal.querySelectorAll(".hidden-tab").forEach(t=>{t.addEventListener("click",t=>{const e=t.target.dataset.tab;this.switchTab(e)})}),this.modal.querySelector("#clear-all-hidden").addEventListener("click",()=>{confirm("Are you sure you want to unhide all users, topics, and subtopics?")&&(window.contentFilter.clearAllHidden(),this.updateUI())}),document.addEventListener("keydown",t=>{"Escape"===t.key&&"none"!==this.modal.style.display&&this.close()})}switchTab(t){this.modal.querySelectorAll(".hidden-tab").forEach(e=>{e.classList.toggle("active",e.dataset.tab===t)}),this.modal.querySelectorAll(".hidden-items-panel").forEach(e=>{e.classList.toggle("active",e.id===`hidden-${t}-panel`)})}updateUI(){if(!window.contentFilter)return;const t=window.contentFilter.getMode(),e=window.contentFilter.getStats();this.modal.querySelectorAll('input[name="filter-mode"]').forEach(e=>{e.checked=e.value===t}),document.getElementById("current-mode-label").textContent=window.contentFilter.getModeLabel(t),document.getElementById("stat-hidden-users").textContent=e.hiddenUsersCount,document.getElementById("stat-hidden-topics").textContent=e.hiddenTopicsCount,document.getElementById("stat-hidden-subtopics").textContent=e.hiddenSubtopicsCount,document.getElementById("hidden-users-count").textContent=e.hiddenUsersCount,document.getElementById("hidden-topics-count").textContent=e.hiddenTopicsCount,document.getElementById("hidden-subtopics-count").textContent=e.hiddenSubtopicsCount,this.updateHiddenUsersList(),this.updateHiddenTopicsList(),this.updateHiddenSubtopicsList()}updateHiddenUsersList(){const t=document.getElementById("hidden-users-list"),e=window.contentFilter.getHiddenUsers();0!==e.length?(t.innerHTML=e.map(t=>`\n            <div class="hidden-item">\n                <span class="hidden-item-name">${this.escapeHtml(t)}</span>\n                <button type="button"\n                        class="btn-unhide"\n                        data-type="user"\n                        data-id="${this.escapeHtml(t)}">\n                    Unhide\n                </button>\n            </div>\n        `).join(""),t.querySelectorAll(".btn-unhide").forEach(t=>{t.addEventListener("click",()=>{window.contentFilter.unhideUser(t.dataset.id),this.updateUI()})})):t.innerHTML='<p class="empty-state">No hidden users</p>'}updateHiddenTopicsList(){const t=document.getElementById("hidden-topics-list"),e=window.contentFilter.getHiddenTopics();0!==e.length?(t.innerHTML=e.map(t=>`\n            <div class="hidden-item">\n                <span class="hidden-item-name">${this.escapeHtml(t)}</span>\n                <button type="button"\n                        class="btn-unhide"\n                        data-type="topic"\n                        data-id="${this.escapeHtml(t)}">\n                    Unhide\n                </button>\n            </div>\n        `).join(""),t.querySelectorAll(".btn-unhide").forEach(t=>{t.addEventListener("click",()=>{window.contentFilter.unhideTopic(t.dataset.id),this.updateUI()})})):t.innerHTML='<p class="empty-state">No hidden topics</p>'}updateHiddenSubtopicsList(){const t=document.getElementById("hidden-subtopics-list"),e=window.contentFilter.getHiddenSubtopics();0!==e.length?(t.innerHTML=e.map(t=>`\n            <div class="hidden-item">\n                <span class="hidden-item-name">${this.escapeHtml(t)}</span>\n                <button type="button"\n                        class="btn-unhide"\n                        data-type="subtopic"\n                        data-id="${this.escapeHtml(t)}">\n                    Unhide\n                </button>\n            </div>\n        `).join(""),t.querySelectorAll(".btn-unhide").forEach(t=>{t.addEventListener("click",()=>{window.contentFilter.unhideSubtopic(t.dataset.id),this.updateUI()})})):t.innerHTML='<p class="empty-state">No hidden subtopics</p>'}open(){this.updateUI(),this.modal.style.display="flex",document.body.style.overflow="hidden"}close(){this.modal.style.display="none",document.body.style.overflow=""}escapeHtml(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{window.filterSettingsModal=new FilterSettingsModal}):window.filterSettingsModal=new FilterSettingsModal;