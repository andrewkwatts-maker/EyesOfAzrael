class SitemapGenerator{constructor(){this.baseUrl="https://eyesofazrael.com",this.db=firebase.firestore()}async generateSitemap(){const t=[];return t.push(...this.getStaticPages()),t.push(...await this.getMythologyPages()),t.push(...await this.getDeityPages()),t.push(...await this.getArchetypePages()),t.push(...await this.getHerbPages()),t.push(...await this.getMagicSystemPages()),t.push(...await this.getSpiritualItemPages()),t.push(...await this.getSpiritualPlacePages()),this.formatSitemap(t)}getStaticPages(){return[{loc:this.baseUrl+"/",lastmod:(new Date).toISOString().split("T")[0],changefreq:"daily",priority:1},{loc:this.baseUrl+"/about.html",lastmod:(new Date).toISOString().split("T")[0],changefreq:"monthly",priority:.8},{loc:this.baseUrl+"/mythos/index.html",lastmod:(new Date).toISOString().split("T")[0],changefreq:"weekly",priority:.9},{loc:this.baseUrl+"/magic/index.html",lastmod:(new Date).toISOString().split("T")[0],changefreq:"weekly",priority:.8},{loc:this.baseUrl+"/herbalism/index.html",lastmod:(new Date).toISOString().split("T")[0],changefreq:"weekly",priority:.8},{loc:this.baseUrl+"/spiritual-items/index.html",lastmod:(new Date).toISOString().split("T")[0],changefreq:"weekly",priority:.7},{loc:this.baseUrl+"/spiritual-places/index.html",lastmod:(new Date).toISOString().split("T")[0],changefreq:"weekly",priority:.7},{loc:this.baseUrl+"/theories/index.html",lastmod:(new Date).toISOString().split("T")[0],changefreq:"daily",priority:.7}]}async getMythologyPages(){try{const t=await this.db.collection("mythologies").get(),e=[];return t.forEach(t=>{const a=t.data(),i=t.id;["comparative","herbalism","themes","freemasons","tarot"].includes(i)||e.push({loc:`${this.baseUrl}/mythos/${i}/index.html`,lastmod:a.updatedAt?.toDate().toISOString().split("T")[0]||(new Date).toISOString().split("T")[0],changefreq:"weekly",priority:.8})}),e}catch(t){return[]}}async getDeityPages(){try{const t=await this.db.collection("deities").get(),e=[];return t.forEach(t=>{const a=t.data(),i=a.mythology?.toLowerCase()||"unknown",r=t.id;e.push({loc:`${this.baseUrl}/mythos/${i}/deities/${r}.html`,lastmod:a.updatedAt?.toDate().toISOString().split("T")[0]||(new Date).toISOString().split("T")[0],changefreq:"monthly",priority:.7})}),e}catch(t){return[]}}async getArchetypePages(){try{const t=await this.db.collection("archetypes").get(),e=[];return t.forEach(t=>{const a=t.data(),i=a.category?.toLowerCase()||"general",r=t.id;e.push({loc:`${this.baseUrl}/archetypes/${i}/${r}/index.html`,lastmod:a.updatedAt?.toDate().toISOString().split("T")[0]||(new Date).toISOString().split("T")[0],changefreq:"monthly",priority:.6})}),e}catch(t){return[]}}async getHerbPages(){try{const t=await this.db.collection("herbs").get(),e=[];return t.forEach(t=>{const a=t.data(),i=t.id;e.push({loc:`${this.baseUrl}/herbalism/${i}.html`,lastmod:a.updatedAt?.toDate().toISOString().split("T")[0]||(new Date).toISOString().split("T")[0],changefreq:"monthly",priority:.6})}),e}catch(t){return[]}}async getMagicSystemPages(){try{const t=await this.db.collection("magic-systems").get(),e=[];return t.forEach(t=>{const a=t.data(),i=t.id;e.push({loc:`${this.baseUrl}/magic/${i}.html`,lastmod:a.updatedAt?.toDate().toISOString().split("T")[0]||(new Date).toISOString().split("T")[0],changefreq:"monthly",priority:.6})}),e}catch(t){return[]}}async getSpiritualItemPages(){try{const t=await this.db.collection("spiritual-items").get(),e=[];return t.forEach(t=>{const a=t.data(),i=t.id;e.push({loc:`${this.baseUrl}/spiritual-items/${i}.html`,lastmod:a.updatedAt?.toDate().toISOString().split("T")[0]||(new Date).toISOString().split("T")[0],changefreq:"monthly",priority:.5})}),e}catch(t){return[]}}async getSpiritualPlacePages(){try{const t=await this.db.collection("spiritual-places").get(),e=[];return t.forEach(t=>{const a=t.data(),i=t.id;e.push({loc:`${this.baseUrl}/spiritual-places/${i}.html`,lastmod:a.updatedAt?.toDate().toISOString().split("T")[0]||(new Date).toISOString().split("T")[0],changefreq:"monthly",priority:.5})}),e}catch(t){return[]}}formatSitemap(t){let e='<?xml version="1.0" encoding="UTF-8"?>\n';return e+='<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">\n',t.forEach(t=>{e+="  <url>\n",e+=`    <loc>${this.escapeXml(t.loc)}</loc>\n`,t.lastmod&&(e+=`    <lastmod>${t.lastmod}</lastmod>\n`),t.changefreq&&(e+=`    <changefreq>${t.changefreq}</changefreq>\n`),t.priority&&(e+=`    <priority>${t.priority}</priority>\n`),e+="  </url>\n"}),e+="</urlset>",e}escapeXml(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}async downloadSitemap(){const t=await this.generateSitemap(),e=new Blob([t],{type:"application/xml"}),a=URL.createObjectURL(e),i=document.createElement("a");i.href=a,i.download="sitemap.xml",i.click(),URL.revokeObjectURL(a)}async saveSitemap(){try{const t=await this.generateSitemap(),e=firebase.storage().ref("sitemap.xml");return await e.putString(t,"raw",{contentType:"application/xml"}),!0}catch(t){return!1}}}"undefined"!=typeof module&&module.exports&&(module.exports=SitemapGenerator);