!function(){"use strict";if("undefined"==typeof firebase)return void i("Firebase SDK not loaded. Please check your internet connection and try again.");if(void 0===window.firebaseApp)return void i("Firebase configuration not found. Please contact the administrator.");const e={app:window.firebaseApp,auth:window.firebaseAuth,db:window.firebaseDb,storage:window.firebaseStorage,initialized:!1,initializing:!1,error:null,currentUser:null,userProfile:null,async initialize(){if(!this.initialized&&!this.initializing){this.initializing=!0;try{if(!(this.app&&this.auth&&this.db&&this.storage))throw new Error("One or more Firebase services failed to initialize");this.auth.onAuthStateChanged(async e=>{this.currentUser=e,e?await this.loadUserProfile(e.uid):this.userProfile=null,window.dispatchEvent(new CustomEvent("firebaseAuthStateChanged",{detail:{user:e,userProfile:this.userProfile}}))}),this.initialized=!0,this.initializing=!1}catch(e){this.error=e,this.initializing=!1,i("Failed to initialize Firebase services: "+e.message)}}},async loadUserProfile(e){try{const i=await this.db.collection("users").doc(e).get();i.exists?this.userProfile={id:e,...i.data()}:this.userProfile=null}catch(e){this.userProfile=null}},async createUserProfile(e){try{const i=this.db.collection("users").doc(e.uid),t=await i.get();if(t.exists)return t.data();{const t={username:e.displayName||"Anonymous",email:e.email,avatar:e.photoURL||"",bio:"",createdAt:firebase.firestore.FieldValue.serverTimestamp(),updatedAt:firebase.firestore.FieldValue.serverTimestamp()};return await i.set(t),this.userProfile={id:e.uid,...t},this.userProfile}}catch(e){throw e}},isAuthenticated(){return null!==this.currentUser},getCurrentUser(){return this.currentUser},getUserProfile(){return this.userProfile},getUserId(){return this.currentUser?this.currentUser.uid:null}};function i(e){const i=document.createElement("div");i.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      background: #ff4444;\n      color: white;\n      padding: 15px;\n      text-align: center;\n      z-index: 10000;\n      font-family: Arial, sans-serif;\n    ",i.innerHTML=`\n      <strong>Firebase Error:</strong> ${e}\n      <button onclick="this.parentElement.remove()" style="margin-left: 20px; background: white; color: #ff4444; border: none; padding: 5px 10px; cursor: pointer; border-radius: 3px;">\n        Dismiss\n      </button>\n    `,document.body?document.body.insertBefore(i,document.body.firstChild):document.addEventListener("DOMContentLoaded",()=>{document.body.insertBefore(i,document.body.firstChild)})}function t(){return new Promise((i,t)=>{if(e.initialized)return void i(e);const r=Date.now(),n=setInterval(()=>{e.initialized?(clearInterval(n),i(e)):Date.now()-r>1e4&&(clearInterval(n),t(new Error("Firebase initialization timeout")))},100)})}e.initialize(),window.FirebaseService=e,window.waitForFirebase=t,window.auth=e.auth,window.db=e.db,window.storage=e.storage,"undefined"!=typeof module&&module.exports&&(module.exports={FirebaseService:e,waitForFirebase:t,auth:e.auth,db:e.db,storage:e.storage})}();