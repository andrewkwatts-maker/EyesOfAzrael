<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shader Background Test - Eyes of Azrael</title>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #0a0e1a;
            color: #f8f9fa;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Shader canvas will be inserted here with z-index: -1 */

        .test-container {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .test-header {
            text-align: center;
            padding: 3rem 0;
            background: rgba(10, 14, 26, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            margin-bottom: 2rem;
            border: 1px solid rgba(139, 127, 255, 0.3);
        }

        .test-header h1 {
            font-size: 3rem;
            background: linear-gradient(135deg, #8b7fff 0%, #ff7eb6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
        }

        .test-header p {
            font-size: 1.2rem;
            color: #adb5bd;
        }

        .controls-panel {
            background: rgba(10, 14, 26, 0.9);
            backdrop-filter: blur(20px);
            padding: 2rem;
            border-radius: 16px;
            margin-bottom: 2rem;
            border: 1px solid rgba(139, 127, 255, 0.3);
        }

        .controls-panel h2 {
            margin-bottom: 1.5rem;
            color: #8b7fff;
        }

        .control-group {
            margin-bottom: 1.5rem;
        }

        .control-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #adb5bd;
            font-weight: 600;
        }

        .theme-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 0.75rem;
        }

        .theme-btn {
            padding: 0.75rem 1rem;
            background: rgba(139, 127, 255, 0.15);
            border: 1px solid rgba(139, 127, 255, 0.3);
            border-radius: 8px;
            color: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            font-weight: 600;
        }

        .theme-btn:hover {
            background: rgba(139, 127, 255, 0.3);
            border-color: #8b7fff;
            transform: translateY(-2px);
        }

        .theme-btn.active {
            background: #8b7fff;
            border-color: #8b7fff;
            box-shadow: 0 4px 16px rgba(139, 127, 255, 0.4);
        }

        .slider-control {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .slider {
            flex: 1;
            height: 8px;
            background: rgba(139, 127, 255, 0.2);
            border-radius: 4px;
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #8b7fff;
            border-radius: 50%;
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #8b7fff;
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        .slider-value {
            min-width: 50px;
            text-align: right;
            font-weight: 600;
            color: #8b7fff;
        }

        .status-panel {
            background: rgba(10, 14, 26, 0.9);
            backdrop-filter: blur(20px);
            padding: 2rem;
            border-radius: 16px;
            border: 1px solid rgba(139, 127, 255, 0.3);
        }

        .status-panel h2 {
            margin-bottom: 1rem;
            color: #8b7fff;
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .status-item {
            background: rgba(139, 127, 255, 0.1);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid rgba(139, 127, 255, 0.2);
        }

        .status-item label {
            display: block;
            font-size: 0.85rem;
            color: #adb5bd;
            margin-bottom: 0.5rem;
        }

        .status-item .value {
            font-size: 1.2rem;
            font-weight: 600;
            color: #8b7fff;
        }

        .status-item .value.good {
            color: #51cf66;
        }

        .status-item .value.bad {
            color: #ff6b6b;
        }

        .test-content {
            background: rgba(10, 14, 26, 0.7);
            backdrop-filter: blur(20px);
            padding: 3rem 2rem;
            border-radius: 16px;
            margin-top: 2rem;
            border: 1px solid rgba(139, 127, 255, 0.3);
            text-align: center;
        }

        .test-content h3 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #f8f9fa;
        }

        .test-content p {
            font-size: 1.1rem;
            color: #adb5bd;
            line-height: 1.8;
            max-width: 700px;
            margin: 0 auto;
        }

        .console-output {
            background: rgba(0, 0, 0, 0.5);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid rgba(139, 127, 255, 0.2);
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: #51cf66;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 1rem;
        }

        .console-output .log-entry {
            margin-bottom: 0.5rem;
            padding: 0.25rem;
        }

        .console-output .log-entry.error {
            color: #ff6b6b;
        }

        .console-output .log-entry.warn {
            color: #ffd93d;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>üé® Shader Background Test</h1>
            <p>Visual verification of WebGL shader system</p>
        </div>

        <div class="controls-panel">
            <h2>üéÆ Shader Controls</h2>

            <div class="control-group">
                <label>Theme Selection:</label>
                <div class="theme-buttons" id="themeButtons">
                    <button class="theme-btn" data-theme="night">üåô Night</button>
                    <button class="theme-btn" data-theme="day">‚òÄÔ∏è Day</button>
                    <button class="theme-btn" data-theme="fire">üî• Fire</button>
                    <button class="theme-btn" data-theme="water">üåä Water</button>
                    <button class="theme-btn" data-theme="earth">üåø Earth</button>
                    <button class="theme-btn" data-theme="air">üí® Air</button>
                    <button class="theme-btn" data-theme="light">‚ú® Light</button>
                    <button class="theme-btn" data-theme="dark">üåë Dark</button>
                    <button class="theme-btn" data-theme="chaos">üåÄ Chaos</button>
                    <button class="theme-btn" data-theme="order">‚öñÔ∏è Order</button>
                </div>
            </div>

            <div class="control-group">
                <label>Intensity:</label>
                <div class="slider-control">
                    <input type="range" min="0" max="100" value="100" class="slider" id="intensitySlider">
                    <span class="slider-value" id="intensityValue">1.00</span>
                </div>
            </div>

            <div class="control-group">
                <label>Quality:</label>
                <div class="theme-buttons">
                    <button class="theme-btn" data-quality="low">Low</button>
                    <button class="theme-btn" data-quality="medium">Medium</button>
                    <button class="theme-btn active" data-quality="high">High</button>
                </div>
            </div>
        </div>

        <div class="status-panel">
            <h2>üìä System Status</h2>
            <div class="status-grid">
                <div class="status-item">
                    <label>WebGL Support</label>
                    <div class="value" id="webglStatus">Checking...</div>
                </div>
                <div class="status-item">
                    <label>Shader Enabled</label>
                    <div class="value" id="enabledStatus">Checking...</div>
                </div>
                <div class="status-item">
                    <label>Current Theme</label>
                    <div class="value" id="themeStatus">None</div>
                </div>
                <div class="status-item">
                    <label>FPS</label>
                    <div class="value" id="fpsStatus">0</div>
                </div>
                <div class="status-item">
                    <label>Quality</label>
                    <div class="value" id="qualityStatus">high</div>
                </div>
                <div class="status-item">
                    <label>Intensity</label>
                    <div class="value" id="intensityStatus">1.0</div>
                </div>
            </div>
            <div class="console-output" id="consoleOutput"></div>
        </div>

        <div class="test-content">
            <h3>Content Visibility Test</h3>
            <p>
                This content should be clearly visible above the animated shader background.
                The shader canvas has z-index: -1, ensuring it stays behind all content.
                Text should remain readable with good contrast against all shader themes.
            </p>
        </div>
    </div>

    <!-- Load Shader System -->
    <script src="js/shaders/shader-themes.js"></script>

    <script>
        // Initialize shader manager
        let shaderManager;
        const consoleOutput = document.getElementById('consoleOutput');
        const logs = [];

        function addLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            logs.push({ timestamp, message, type });
            if (logs.length > 20) logs.shift(); // Keep last 20 logs

            consoleOutput.innerHTML = logs.map(log =>
                `<div class="log-entry ${log.type}">[${log.timestamp}] ${log.message}</div>`
            ).join('');
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }

        // Override console methods to capture logs
        const originalLog = console.log;
        const originalWarn = console.warn;
        const originalError = console.error;

        console.log = function(...args) {
            originalLog.apply(console, args);
            addLog(args.join(' '), 'info');
        };

        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addLog(args.join(' '), 'warn');
        };

        console.error = function(...args) {
            originalError.apply(console, args);
            addLog(args.join(' '), 'error');
        };

        // Initialize
        addLog('Initializing shader system...');

        if (typeof ShaderThemeManager !== 'undefined') {
            shaderManager = new ShaderThemeManager({
                quality: 'high',
                targetFPS: 60,
                adaptiveQuality: true
            });

            addLog('ShaderThemeManager created successfully');

            // Activate initial theme
            const hour = new Date().getHours();
            const initialTheme = (hour >= 6 && hour < 18) ? 'day' : 'night';

            addLog(`Activating initial theme: ${initialTheme}`);
            shaderManager.activate(initialTheme);

            // Update active button
            document.querySelector(`[data-theme="${initialTheme}"]`)?.classList.add('active');

            // Update status every second
            setInterval(updateStatus, 1000);

        } else {
            addLog('ERROR: ShaderThemeManager not found!', 'error');
            document.getElementById('webglStatus').textContent = 'Not Loaded';
            document.getElementById('webglStatus').classList.add('bad');
        }

        function updateStatus() {
            if (!shaderManager) return;

            const status = shaderManager.getStatus();

            // WebGL Support
            const webglEl = document.getElementById('webglStatus');
            webglEl.textContent = status.supported ? 'Yes' : 'No';
            webglEl.className = 'value ' + (status.supported ? 'good' : 'bad');

            // Enabled
            const enabledEl = document.getElementById('enabledStatus');
            enabledEl.textContent = status.enabled ? 'Yes' : 'No';
            enabledEl.className = 'value ' + (status.enabled ? 'good' : 'bad');

            // Theme
            document.getElementById('themeStatus').textContent = status.theme || 'None';

            // FPS
            const fpsEl = document.getElementById('fpsStatus');
            fpsEl.textContent = status.fps;
            fpsEl.className = 'value ' + (status.fps >= 50 ? 'good' : status.fps >= 30 ? '' : 'bad');

            // Quality
            document.getElementById('qualityStatus').textContent = status.quality;

            // Intensity
            document.getElementById('intensityStatus').textContent = status.intensity.toFixed(2);
        }

        // Theme buttons
        document.getElementById('themeButtons').addEventListener('click', (e) => {
            if (e.target.dataset.theme) {
                const theme = e.target.dataset.theme;
                addLog(`Switching to theme: ${theme}`);

                // Remove active class from all theme buttons
                document.querySelectorAll('[data-theme]').forEach(btn =>
                    btn.classList.remove('active')
                );

                // Add active class to clicked button
                e.target.classList.add('active');

                // Activate shader
                if (shaderManager) {
                    shaderManager.activate(theme);
                }
            }

            if (e.target.dataset.quality) {
                const quality = e.target.dataset.quality;
                addLog(`Changing quality to: ${quality}`);

                // Remove active class from all quality buttons
                document.querySelectorAll('[data-quality]').forEach(btn =>
                    btn.classList.remove('active')
                );

                // Add active class to clicked button
                e.target.classList.add('active');

                // Change quality
                if (shaderManager) {
                    shaderManager.settings.quality = quality;
                    shaderManager.handleResize();
                }
            }
        });

        // Intensity slider
        const intensitySlider = document.getElementById('intensitySlider');
        const intensityValue = document.getElementById('intensityValue');

        intensitySlider.addEventListener('input', (e) => {
            const value = e.target.value / 100;
            intensityValue.textContent = value.toFixed(2);

            if (shaderManager) {
                shaderManager.setIntensity(value);
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.key === ' ') {
                e.preventDefault();
                if (shaderManager) {
                    const enabled = shaderManager.toggle();
                    addLog(`Shader ${enabled ? 'enabled' : 'disabled'}`);
                }
            }
        });

        addLog('Test page ready! Press SPACE to toggle shaders.');
    </script>
</body>
</html>
